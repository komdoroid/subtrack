# 画面構成定義書 (`screen_description.md`)

## 1. 概要
- **このドキュメントの目的**：UI改善・機能実装時の参照元として、各画面の詳細仕様を明確化
- **対象アプリ名**：SubTrack（サブスクリプション管理アプリ）
- **画面数（合計）**：5画面

---

## 2. 画面一覧

| 画面ID | 画面名                 | パス（URL）         | 概要                                      |
|--------|------------------------|---------------------|-------------------------------------------|
| S01    | ランディングページ     | /                   | アプリ紹介・ログイン導線画面              |
| S02    | 認証画面               | /auth               | ユーザーログイン・新規登録画面            |
| S03    | ダッシュボード         | /dashboard          | サブスク概要・グラフ・登録フォーム統合画面 |
| S04    | 一覧管理画面           | /list               | サブスク詳細管理・フィルタリング画面      |
| S05    | 分析画面               | /analytics          | 年間支出見積もり・カテゴリ分析画面        |

---

## 3. 各画面の詳細情報

### S01. ランディングページ

- **パス**：`/`
- **目的**：アプリの価値提案・新規ユーザー獲得・既存ユーザーのログイン導線
- **主な構成要素**：
  - ヘッダー：アプリタイトル「サブスク、見える化しよう」
  - キャッチコピー：「毎月のサブスクリプション、いくら使ってるか把握できていますか？」
  - CTAボタン：「ダッシュボードを見る」「ログイン」
  - 機能紹介セクション：「支払いの可視化」「自動で翌月に繰り越し」
  - フッター：著作権情報
- **画面レイアウト（概要）**：
  - 中央寄せの1カラム構成
  - ヒーロー部分 + 機能説明グリッド（2カラム）
- **ユーザー操作**：
  - 「ダッシュボードを見る」→ `/dashboard` へ遷移
  - 「ログイン」→ `/auth` へ遷移
- **備考**：
  - 未認証ユーザー向けの完全パブリック画面
  - レスポンシブ対応済み

---

### S02. 認証画面

- **パス**：`/auth`
- **目的**：既存ユーザーのログイン・新規ユーザー登録
- **主な構成要素**：
  - 切り替えタブ：「ログイン」「新規登録」
  - 入力フォーム：メールアドレス、パスワード（8文字以上）
  - 実行ボタン：「ログイン」または「登録」
  - 状態切り替えリンク：「新規登録はこちら」「ログインはこちら」
  - エラーメッセージ表示エリア
- **画面レイアウト（概要）**：
  - 中央寄せのカード型フォーム（max-width: md）
  - 背景：グレー系グラデーション
- **ユーザー操作**：
  - 認証成功 → `/dashboard` へ自動遷移
  - モード切り替え → 同一画面内でフォーム変更
- **バリデーション**：
  - メール形式チェック
  - パスワード最小文字数（8文字）
- **備考**：
  - Firebase Authentication使用
  - autoComplete属性対応

---

### S03. ダッシュボード

- **パス**：`/dashboard`
- **目的**：ユーザーのサブスクリプション情報を統合的に俯瞰
- **主な構成要素**：
  - **共通レイアウト**：AppShell（ヘッダー + サイドバー + メイン）
  - **ヘッダー（Navbar）**：アプリタイトル「SubTrack」、ログアウトボタン
  - **サイドバー**：ナビゲーションメニュー（ダッシュボード、一覧、分析）
  - **メインコンテンツ**：
    - ウェルカムメッセージ（ユーザーメール表示）
    - 月別支出グラフ（SubscriptionChart）
    - サブスクリプション一覧（SubscriptionList）
    - 新規登録フォーム（SubscriptionForm）
- **画面レイアウト（概要）**：
  - 2カラム構成（左：サイドバー264px、右：メインコンテンツ）
  - メインコンテンツは垂直スクロール
- **ユーザー操作**：
  - サイドバーナビゲーション → 各画面遷移
  - グラフのツールチップ表示
  - サブスク一覧の編集・削除ボタン
  - フォーム入力・送信
- **備考**：
  - 認証必須（useAuth利用）
  - リアルタイムデータ更新対応

---

### S04. 一覧管理画面

- **パス**：`/list`
- **目的**：サブスクリプションの詳細管理・高度なフィルタリング
- **主な構成要素**：
  - **共通レイアウト**：AppShell
  - **フィルターセクション**：
    - カテゴリ選択（Select）
    - 月選択（現在、過去12ヶ月から選択）
    - 価格範囲（最小・最大入力）
    - 検索クエリ（サービス名・カテゴリ検索）
  - **サブスク一覧**：
    - カード形式表示（3カラムグリッド）
    - 各カード：サービス名、カテゴリ、価格、支払日、開始日、終了日
    - 編集・削除ボタン付き
  - **編集モーダル**：
    - サービス名、価格、カテゴリ、請求日の編集
    - 保存・キャンセルボタン
- **画面レイアウト（概要）**：
  - フィルター部分：5カラムグリッド（MD以上）
  - 一覧部分：レスポンシブグリッド（1〜3カラム）
- **ユーザー操作**：
  - 各フィルターの変更 → リアルタイム絞り込み
  - 編集ボタン → モーダル表示
  - 削除ボタン → 確認後削除実行
- **機能詳細**：
  - 複数条件でのAND検索
  - 状態管理による即座のフィルタリング
- **備考**：
  - 大量データ対応検討中
  - モバイル対応でフィルター折りたたみ推奨

---

### S05. 分析画面

- **パス**：`/analytics`
- **目的**：支出の深い分析・年間見積もり・トレンド把握
- **主な構成要素**：
  - **共通レイアウト**：AppShell
  - **年間支出見積もりセクション（AnnualExpenseEstimation）**：
    - 中央表示の合計金額（大文字）
    - クリック展開による詳細表示
    - カテゴリ別小計・サービス別内訳
    - 利用期間表示（○ヶ月間利用）
  - **月別支出推移グラフ（LineChart）**：
    - 過去6ヶ月の実績データ
    - インタラクティブなツールチップ
  - **カテゴリ別円グラフ（PieChart）**：
    - 当月のカテゴリ別割合
    - カスタムカラーパレット
- **画面レイアウト（概要）**：
  - 垂直積み上げ式（年間見積もり → 月別 → カテゴリ別）
  - 各セクションはカード形式
- **ユーザー操作**：
  - 年間見積もりクリック → 詳細展開/折りたたみ
  - グラフホバー → データ詳細表示
- **計算ロジック**：
  - date-fns使用による正確な月数計算
  - 契約期間の今年該当分のみ算出
- **備考**：
  - 新規実装機能（年間支出見積もり）
  - Rechartsライブラリ使用

---

## 4. 共通コンポーネント定義

| コンポーネント名          | 説明                             | 使用画面                   | ファイルパス                      |
|---------------------------|----------------------------------|----------------------------|-----------------------------------|
| AppShell                  | 共通レイアウト（ヘッダー・サイドバー） | S03, S04, S05              | src/components/layout/AppShell.tsx |
| Navbar                    | 上部ナビゲーションバー           | S03, S04, S05（AppShell内） | src/components/Navbar.tsx         |
| SubscriptionCard          | サブスク情報のカード表示         | S03, S04                   | src/components/SubscriptionItem.tsx |
| SubscriptionForm          | 新規登録フォーム                 | S03                        | src/components/SubscriptionForm.tsx |
| SubscriptionChart         | 月別支出グラフ                   | S03                        | src/components/SubscriptionChart.tsx |
| AnnualExpenseEstimation   | 年間支出見積もり                 | S05                        | src/components/ui/AnnualExpenseEstimation.tsx |
| AnalysisPage              | 分析画面メインコンポーネント     | S05                        | src/components/ui/AnalysisPage.tsx |

---

## 5. デザインガイド

- **カラースキーム**：
  - 背景：`bg-gray-50`（アプリ全体）、`bg-white`（カード）
  - 文字色：`text-gray-800`（メイン）、`text-gray-600`（サブ）
  - アクセント：`text-blue-600`（金額・重要情報）、`text-red-600`（削除・エラー）
- **フォントとサイズ**：
  - Geist Sans（メイン）、Geist Mono（モノスペース）
  - タイトル：`text-2xl〜4xl`、本文：`text-sm〜base`
- **レスポンシブ対応**：
  - モバイルファースト設計
  - ブレークポイント：sm(640px), md(768px), lg(1024px)
  - サイドバー：lg以下で非表示
- **UIライブラリ**：
  - **CSS Framework**：Tailwind CSS
  - **Component Library**：Radix UI（Select, Label等）
  - **Icons**：Lucide React
  - **Charts**：Recharts

---

## 6. 備考・変更履歴

| 日付       | 変更内容                            | 担当       |
|------------|-------------------------------------|------------|
| 2025/01/16 | 初版作成                            | kom        |
| 2025/01/16 | 年間支出見積もり機能追加対応        | kom        |

**技術的補足**：
- **状態管理**：React hooks（useState, useEffect）
- **認証**：Firebase Authentication + カスタムuseAuthフック
- **データベース**：Firestore（リアルタイム同期）
- **ルーティング**：Next.js App Router
- **型安全性**：TypeScript完全対応

**既知の課題**：
- モバイルでのグラフ表示最適化
- 大量データ表示時のパフォーマンス
- アクセシビリティ対応
- ダークモード対応 